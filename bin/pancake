#!/bin/bash

function main {
  if [[ "$#" < 1 ]]; then
    echo "missing pancake subcommand"
    exit 1
  fi

  local nm_component="$1"; shift

  case "$nm_component" in
    init)
      cat <<EOF
      if [[ -f /opt/.profile ]]; then source /opt/.profile; fi;

      pushd ~ > /dev/null;

      if [[ -f .hubflow/.profile ]]; then source .hubflow/.profile; fi;
      if [[ -d .rvm ]];              then source .rvm/scripts/rvm; 
                                          rvm default; fi;
      if [[ -f .rbenv/.profile ]];   then source .rbenv/.profile; fi
      if [[ -f .cue/.profile ]];     then source .cue/.profile; fi

      popd > /dev/null;
EOF
      echo 'PATH="$HOME/.getting-started/bootstrap:$PATH"'
      ;;
    shell)
      eval "$($0 init)"
      local bash_opt=""

      exec bash $bash_opt -i
      ;;
    *)
      cd "$HOME/.getting-started"
      bin/$nm_component "$@"
      ;;
  esac
}

# pass arguments to entry point
main "$@"
